+++
title = "Open Redirect Vulnerability"
date = 2020-05-14T00:38:32+07:00
weight = 1
chapter = false
pre = "<b>1. </b>"
+++

Open Redirect Vulnerability is an security weakness where an attacker could supply a malicious URL as an input, potentially leading users to phishing or malware sites. This is a common security flaw in web applications that can be exploited to conduct phishing attacks or distribute malware.

1. First, create a folder. Then, create a .py file inside it and paste the code into the file.

   ```
   from flask import app

   @app.route('/redirect')

   def redirect_url_noncompliant():

       from flask import request, redirect
       endpoint = request.args['url']
       # Noncompliant: redirect to a user-supplied URL without sanitization.

       return redirect(endpoint)
   ```

2. Click on Amazon Q in the status bar and run Project Scan to see how the Open Redirect Vulnerability is detected.
   ![Secure-code](/images/1/secure-code-1.png?width=90pc)

3. Select **Review workspace** or **Review active file**
   ![Open-redirect-1](/images/1/open-redirect-1.png?width=90pc)

4. The following finding will be visible in the status bar
   ![Open-redirect-2](/images/1/open-redirect-2.png?width=90pc)

5. To views details of the findings, hold your cursor over the insecure code and click on "View Details" to learn more:
   ![Open-redirect-3](/images/1/open-redirect-3.png?width=90pc)
   ![Open-redirect-4](/images/1/open-redirect-4.png?width=90pc)

6. To fix the open redirect issue in the provided code snippet, you should validate and/or sanitize the URL before performing the redirection. For example, only allow redirects to known, safe domains by checking the user-supplied URL against a whitelist.

   Below is an example of how this code can be fixed. Make sure to save the file prior to re-running the scan.

   ```
   from flask import Flask, request, redirect, url_for

   app = Flask(__name__)

   ALLOWED_HOSTS = ['www.example.com', 'example.org']

   @app.route('/redirect')
   def redirect_url():
      from urllib.parse import urlparse

      # Retrieve the URL from request arguments and parse it
      user_url = request.args.get('url', '')
      parsed_url = urlparse(user_url)

      # Check if the URL's host is in the list of allowed hosts
      if parsed_url.netloc in ALLOWED_HOSTS:
         return redirect(user_url)
      else:
         # Redirect to a default page or show an error
         return redirect(url_for('index'))  # Assume 'index' is a valid endpoint
   ```

7. Try fixing the issue and running the scan again.
